/*! Lity - v3.0.0-dev - 2018-04-20
* http://sorgalla.com/lity/
* Copyright (c) 2015-2018 Jan Sorgalla; Licensed MIT */
(function(b,a){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return a(b,c)})}else{if(typeof module==="object"&&typeof module.exports==="object"){module.exports=a(b,require("jquery"))}else{b.lity=a(b,b.jQuery||b.Zepto)}}}(typeof window!=="undefined"?window:this,function(r,j){var z=r.document;var q=j(r);var h=j.Deferred;var c=j("html");var u=[];var o="aria-hidden";var m="lity-"+o;var x='a[href],area[href],input:not([disabled]),select:not([disabled]),textarea:not([disabled]),button:not([disabled]),iframe,object,embed,[contenteditable],[tabindex]:not([tabindex^="-"])';var s={esc:true,handler:null,handlers:{image:D,inline:B,iframe:i},template:'<div class="lity" role="dialog" aria-label="Dialog Window (Press escape to close)" tabindex="-1"><div class="lity-wrap" data-lity-close role="document"><div class="lity-loader" aria-hidden="true">Loading...</div><div class="lity-container"><div class="lity-content"></div><button class="lity-close" type="button" aria-label="Close (Press escape to close)" data-lity-close>&times;</button></div></div></div>'};var g=/(^data:image\/)|(\.(png|jpe?g|gif|svg|webp|bmp|ico|tiff?)(\?\S*)?$)/i;var f=(function(){var J=z.createElement("div");var I={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var H in I){if(J.style[H]!==undefined){return I[H]}}return false})();function n(I){var H=h();if(!f||!I.length){H.resolve()}else{I.one(f,H.resolve);setTimeout(H.resolve,500)}return H.promise()}function E(I,H,J){if(arguments.length===1){return j.extend({},I)}if(typeof H==="string"){if(typeof J==="undefined"){return typeof I[H]==="undefined"?null:I[H]}I[H]=J}else{j.extend(I,H)}return this}function y(L){var N=L.indexOf("?");if(N>-1){L=L.substr(N+1)}var I=decodeURI(L.split("#")[0]).split("&");var K={},J;for(var H=0,M=I.length;H<M;H++){if(!I[H]){continue}J=I[H].split("=");K[J[0]]=J[1]}return K}function A(H,J){if(!J){return H}if("string"===j.type(J)){J=y(J)}if(H.indexOf("?")>-1){var I=H.split("?");H=I.shift();J=j.extend({},y(I[0]),J)}return H+"?"+j.param(J)}function e(H,I){var J=H.indexOf("#");if(-1===J){return I}if(J>0){H=H.substr(J)}return I+H}function p(J,H,K,I){H&&H.element().addClass("lity-iframe");if(K){J=A(J,K)}if(I){J=e(I,J)}return'<div class="lity-iframe-container"><iframe frameborder="0" allowfullscreen src="'+J+'"/></div>'}function C(H){return j('<span class="lity-error"/>').append(H)}function D(L,H){var M=(H.opener()&&H.opener().data("lity-desc"))||"Image with no description";var K=j('<img src="'+L+'" alt="'+M+'"/>');var J=h();var I=function(){J.reject(C("Failed loading image"))};K.on("load",function(){if(this.naturalWidth===0){return I()}J.resolve(K)}).on("error",I);return J.promise()}D.test=function(H){return g.test(H)};function B(L,H){var I,M,J;try{I=j(L)}catch(K){return false}if(!I.length){return false}M=j('<i style="display:none !important"/>');J=I.hasClass("lity-hide");H.element().one("lity:remove",function(){M.before(I).remove();if(J&&!I.closest(".lity-content").length){I.addClass("lity-hide")}});return I.removeClass("lity-hide").after(M)}function i(I,H){return p(I,H)}function d(){return z.documentElement.clientHeight?z.documentElement.clientHeight:Math.round(q.height())}function w(I){var H=t();if(!H){return}if(I.keyCode===27&&!!H.options("esc")){H.close()}if(I.keyCode===9){a(I,H)}}function a(J,H){var I=H.element().find(x);var K=I.index(z.activeElement);if(J.shiftKey&&K<=0){I.get(I.length-1).focus();J.preventDefault()}else{if(!J.shiftKey&&K===I.length-1){I.get(0).focus();J.preventDefault()}}}function G(){j.each(u,function(I,H){H.resize()})}function v(H){if(1===u.unshift(H)){c.addClass("lity-active");q.on({resize:G,keydown:w})}j("body > *").not(H.element()).addClass("lity-hidden").each(function(){var I=j(this);if(undefined!==I.data(m)){return}I.data(m,I.attr(o)||null)}).attr(o,"true")}function F(I){var H;I.element().attr(o,"true");if(1===u.length){c.removeClass("lity-active");q.off({resize:G,keydown:w})}u=j.grep(u,function(J){return I!==J});if(!!u.length){H=u[0].element()}else{H=j(".lity-hidden")}H.removeClass("lity-hidden").each(function(){var K=j(this),J=K.data(m);if(!J){K.removeAttr(o)}else{K.attr(o,J)}K.removeData(m)})}function t(){if(0===u.length){return null}return u[0]}function k(M,H,J,I){var K="inline",L;var N=j.extend({},J);if(I&&N[I]){L=N[I](M,H);K=I}else{j.each(["inline","iframe"],function(P,O){delete N[O];N[O]=J[O]});j.each(N,function(O,P){if(!P){return true}if(P.test&&!P.test(M,H)){return true}L=P(M,H);if(false!==L){K=O;return false}})}return{handler:K,content:L||""}}function l(L,Q,O,I){var P=this;var R;var M=false;var H=false;var J;var K;Q=j.extend({},s,Q);J=j(Q.template);P.element=function(){return J};P.opener=function(){return O};P.content=function(){return K};P.options=j.proxy(E,P,Q);P.handlers=j.proxy(E,P,Q.handlers);P.resize=function(){if(!M||H){return}K.css("max-height",d()+"px").trigger("lity:resize",[P])};P.close=function(){if(!M||H){return}H=true;F(P);var S=h();if(I&&(z.activeElement===J[0]||j.contains(J[0],z.activeElement))){try{I.focus()}catch(T){}}K.trigger("lity:close",[P]);J.removeClass("lity-opened").addClass("lity-closed");n(K.add(J)).always(function(){K.trigger("lity:remove",[P]);J.remove();J=undefined;S.resolve()});return S.promise()};R=k(L,P,Q.handlers,Q.handler);J.attr(o,"false").addClass("lity-loading lity-opened lity-"+R.handler).appendTo("body").focus().on("click","[data-lity-close]",function(S){if(j(S.target).is("[data-lity-close]")){P.close()}}).trigger("lity:open",[P]);v(P);j.when(R.content).always(N);function N(S){K=j(S).css("max-height",d()+"px");J.find(".lity-loader").each(function(){var T=j(this);n(T).always(function(){T.remove()})});J.removeClass("lity-loading").find(".lity-content").empty().append(K);M=true;K.trigger("lity:ready",[P])}}function b(K,I,J){if(!K.preventDefault){J=j(J)}else{K.preventDefault();J=j(this);K=J.data("lity-target")||J.attr("href")||J.attr("src")}var H=new l(K,j.extend({},J.data("lity-options")||J.data("lity"),I),J,z.activeElement);if(!K.preventDefault){return H}}b.version="3.0.0-dev";b.options=j.proxy(E,b,s);b.handlers=j.proxy(E,b,s.handlers);b.current=t;b.iframe=p;j(z).on("click.lity","[data-lity]",b);return b}));
